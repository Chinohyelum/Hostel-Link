<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reset Password</title>

<link rel="stylesheet" href="{{ url_for('static', filename='students/auth.css') }}">
</head>

<body>
<div class="loginwrapper">

<h2>Reset Password</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <p class="flash">{{ message }}</p>
    {% endfor %}
  {% endif %}
{% endwith %}

<form method="POST"
      action="{{ url_for('student.reset_password_submit', token=token) }}"
      id="resetForm">

<label>New Password</label>
<input type="password" id="password" name="password" required>

<label>Confirm Password</label>
<input type="password" id="confirm_password" name="confirm_password" required>

<div class="help-links">
    <a href="#" id="togglePassword">Show password</a>
</div>

<button class="submit-btn" id="resetBtn">Reset Password</button>

</form>
</div>

<script>
const pass=document.getElementById("password");
const confirm=document.getElementById("confirm_password");

document.getElementById("togglePassword").addEventListener("click",e=>{
    e.preventDefault();
    const show=pass.type==="password";
    pass.type=show?"text":"password";
    confirm.type=show?"text":"password";
});

document.getElementById("resetForm").addEventListener("submit",e=>{
    if(pass.value.length < 6){
        e.preventDefault();
        alert("Password must be at least 6 characters");
        return;
    }

    if(pass.value !== confirm.value){
        e.preventDefault();
        alert("Passwords do not match");
        return;
    }

    const btn=document.getElementById("resetBtn");
    btn.disabled=true;
    btn.textContent="Resetting...";
});
</script>

</body>
</html>
