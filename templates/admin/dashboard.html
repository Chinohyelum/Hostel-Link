<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin_dashboard.css') }}">
</head>
<body>

<!-- TOP NAVBAR (uses your existing elements/classes; does not change routes) -->
<header class="navbar">
    <div class="logo">üè® HostelLink</div>

    <!-- NOTE: Using your real Flask links. No new routes invented. -->
    <nav class="nav">
        <a class="nav-link nav-active" href="{{ url_for('dashboard.admin_dashboard') }}">Dashboard</a>
        <a class="nav-link" href="{{ url_for('hostel.create_hostel') }}">Hostels</a>
        <a class="nav-link" href="/admin/room-swap-requests">Room Swaps</a>
        <a class="nav-link" href="/admin/cancellation-requests">Cancellations</a>
        <a class="nav-link" href="/admin/notifications">Notifications</a>
    </nav>

    <div class="user">
        <!-- Keep hamburger functionality for mobile sidebar drawer -->
        <!-- <button class="icon-btn" id="openSidebar" type="button" aria-label="Open menu">‚ò∞</button> -->

        <a class="logout-btn" href="/logout">Logout</a>

        <a class="profile-chip" href="{{ url_for('admin.admin_profile') }}" title="Edit Profile">
            {% if admin and admin['profile_picture'] %}
                <img class="profile-avatar"
                     src="{{ url_for('static', filename=admin['profile_picture']) }}"
                     alt="Profile">
            {% else %}
                <div class="profile-avatar profile-fallback">
                    {% if admin %}
                        {{ (admin['first_name'][:1] ~ admin['last_name'][:1]) | upper }}
                    {% else %}
                        AD
                    {% endif %}
                </div>
            {% endif %}
        </a>
    </div>
</header>

<main class="container">
    <!-- FLASH -->
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <p class="flash">{{ messages[0] }}</p>
      {% endif %}
    {% endwith %}

    <!-- WELCOME / HERO -->
    <section class="dash-hero card">
        <div class="welcome">
            <h2 style="margin:0;">Welcome back{% if admin %}, {{ admin['first_name'] }}{% endif %}</h2>
            <p class="welcome-sub">
                Your admin dashboard for hostel management. Quick access to all your tasks.
            </p>
        </div>

        <div class="hero-badges">
            <span class="pill">Hostels: <strong>{{ hostel_count }}</strong></span>
            <span class="pill">Room Swaps: <strong>{{ room_swap_pending }}</strong></span>
            <span class="pill">Cancellations: <strong>{{ cancel_pending }}</strong></span>
        </div>
    </section>

    <!-- QUICK CARDS -->
    <section class="cards">
        <div class="dash-card">
            <h3>Hostels</h3>
            <p class="dash-number">{{ hostel_count }}</p>
            <a class="dash-link" href="{{ url_for('hostel.create_hostel') }}">Create / Manage ‚Üí</a>
        </div>

        <div class="dash-card">
            <h3>Room Swap Requests</h3>
            <p class="dash-number">{{ room_swap_pending }}</p>
            <a class="dash-link" href="/admin/room-swap-requests">View ‚Üí</a>
        </div>

        <div class="dash-card">
            <h3>Cancellation Requests</h3>
            <p class="dash-number">{{ cancel_pending }}</p>
            <a class="dash-link" href="/admin/cancellation-requests">View ‚Üí</a>
        </div>
    </section>

    <!-- QUICK ACTIONS -->
    <section class="dash-section card">
        <h3 style="margin-top:0;">Quick Actions</h3>
        <div class="actions">
            <a class="action-btn" href="{{ url_for('hostel.create_hostel') }}">Create Hostel</a>
            <a class="action-btn" href="/admin/create-student">Create Student</a>
            <a class="action-btn" href="/admin/create-admin">Create Admin</a>
            <a class="action-btn" href="/admin/notifications">Notifications</a>
        </div>
    </section>
</main>

<footer class="footer">
    <div>
        <p>¬© 2026 HostelLink. All rights reserved.</p>
    </div>

    <div class="split">
        <a href="#">Privacy Policy</a>
        <a href="#">Terms of Services</a>
    </div>
</footer>

<!-- SIDEBAR OVERLAY MENU (hidden by default) -->
<div class="overlay" id="overlay"></div>

<aside class="sidebar-drawer" id="sidebar">
    <div class="sidebar-header">
        <div class="brand">
            <span class="brand-dot"></span>
            <span class="brand-text">Hostel Link</span>
        </div>
        <button class="icon-btn" id="closeSidebar" type="button" aria-label="Close menu">‚úï</button>
    </div>

    <!-- We keep your nav commented if you want it later. This is still safe. -->
    <!--
    <nav class="nav">
        <a class="nav-link" href="{{ url_for('dashboard.admin_dashboard') }}">Dashboard</a>
        <a class="nav-link" href="{{ url_for('hostel.create_hostel') }}">Create / Manage Hostels</a>
        <a class="nav-link" href="/admin/create-student">Create Student</a>
        <a class="nav-link" href="/admin/create-admin">Create Admin</a>
        <a class="nav-link" href="/admin/notifications">Notifications</a>
        <a class="nav-link" href="/admin/room-swap-requests">Room Swap Requests</a>
        <a class="nav-link" href="/admin/cancellation-requests">Cancellation Requests</a>
        <a class="nav-link" href="{{ url_for('admin.admin_profile') }}">Profile</a>
    </nav>
    -->

    <a class="nav-link nav-link-danger" href="/logout">Logout</a>
</aside>

<script>
const sidebar = document.getElementById("sidebar");
const overlay = document.getElementById("overlay");
const openBtn = document.getElementById("openSidebar");
const closeBtn = document.getElementById("closeSidebar");

function openSidebar(){
  sidebar.classList.add("drawer-open");
  overlay.classList.add("overlay-show");
}
function closeSidebar(){
  sidebar.classList.remove("drawer-open");
  overlay.classList.remove("overlay-show");
}

openBtn.addEventListener("click", openSidebar);
closeBtn.addEventListener("click", closeSidebar);
overlay.addEventListener("click", closeSidebar);

// Escape closes menu
document.addEventListener("keydown", (e) => {
  if(e.key === "Escape") closeSidebar();
});


  const hostelInput = document.getElementById("hostel_image");
  const preview = document.getElementById("hostelPreview");

  if (hostelInput) {
    hostelInput.addEventListener("change", () => {
      const file = hostelInput.files && hostelInput.files[0];
      if (!file) {
        preview.style.display = "none";
        preview.src = "";
        return;
      }
      preview.src = URL.createObjectURL(file);
      preview.style.display = "block";
    });
  }
</script>

</body>
</html>
